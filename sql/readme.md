This is for SQL\
Between is inclusive in both sides\
when calul, use case to avoid null \
Pay attention to the window function. lag() OVER(ORDER BY) partition is not needed\
this function is useful DATE_ADD('2019-07-27', INTERVAL -29 DAY)\
pay attention to date, it's str and should be attached with ''\
EXTRACT(MONTH FROM "2017-06-15")\

